<div class="container my-4">

  <h2 class="mb-4">Buscar por G√©nero</h2>

  <div class="row mb-4">
    <div class="col-md-8">
      <div class="card">
        <div class="card-body">

          <label for="busqueda-input" class="form-label">
            <strong>Criterio de b√∫squeda:</strong>
          </label>

          <div class="input-group mb-3">
            <input
              type="text"
              id="busqueda-input"
              class="form-control"
              [(ngModel)]="terminoBusqueda"
              placeholder="Ej: action, adventure, rpg"
              (keyup.enter)="buscar()"
              aria-label="T√©rmino de b√∫squeda"
              aria-describedby="buscar-button">

            <button
              class="btn btn-primary"
              id="buscar-button"
              (click)="buscar()"
              [disabled]="!terminoBusqueda.trim()"
              aria-label="Buscar elementos">
              üîç Buscar
            </button>

            @if (terminoBusqueda || datos.length > 0) {
              <button
                class="btn btn-outline-secondary"
                (click)="limpiar()"
                aria-label="Limpiar b√∫squeda">
                ‚úñÔ∏è Limpiar
              </button>
            }
          </div>

          <small class="text-muted">
            üí° Presiona Enter o haz clic en Buscar
          </small>

        </div>
      </div>
    </div>
  </div>

  @if (cargando) {
    <div class="text-center my-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Buscando...</span>
      </div>
      <p class="mt-3">Buscando resultados...</p>
    </div>
  }

  @else if (datos.length > 0) {
    <h3 class="mb-3">
      Resultados encontrados:
      <span class="badge bg-success">{{ datos.length }}</span>
    </h3>

    <div class="row row-cols-1 row-cols-md-3 g-4">
      @for (item of datos; track item.id) {
        <div class="col">
          <div class="card h-100 shadow-sm">
            
            <img [src]="item.background_image"
                 class="card-img-top"
                 [alt]="item.name"
                 style="height: 200px; object-fit: cover;">

            <div class="card-body d-flex flex-column">
              <h5 class="card-title">{{ item.name }}</h5>
              
              <p class="card-text text-muted mb-2">
                <small>üìÖ {{ item.released | date:'dd/MM/yyyy' }}</small>
              </p>
              
              <p class="card-text mb-3">
                <span class="badge bg-primary">
                  {{ item.rating | number:'1.1-1' }} ‚≠ê
                </span>
              </p>

              <div class="mt-auto">
                <a [routerLink]="['/lista', item.id]"
                   class="btn btn-info text-white w-100"
                   [attr.aria-label]="'Ver detalles de ' + item.name">
                  Ver Detalle
                </a>
              </div>

            </div>
          </div>
        </div>
      }
    </div>
  }

  @else if (busquedaRealizada && !cargando) {
    <div class="alert alert-info" role="alert">
      <h4 class="alert-heading">‚ÑπÔ∏è Sin resultados</h4>
      <p>No se encontraron elementos para <strong>"{{ terminoBusqueda }}"</strong>.</p>
      <hr>
      <p class="mb-0">Intenta con otro t√©rmino de b√∫squeda.</p>
    </div>
  }

</div>